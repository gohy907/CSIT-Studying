# Команды

## Форматы команд
\[код операции]\[адресная часть]

Команда --- этой цифровой двоичный код, состоящий из двух подпоследовательностей двоичных цифр, одна из которых определяет код операции (сложить, умножить, переслать), вторая --- определяет операнды, участвующие в операции и место хранения результата

Рассматриваемый процессор может работать с безадресными командами, одно-, двух- и трехадресными командами. Команда в памяти может занимать от 1 до 15 байт и длина команды зависит от кода операции, количества и места расположения операндов. Одноадресные команды могут работать с операндами, расположенными в памяти и регистрах, для двухадресных команд существует много форматов, такие, как:
- R-R
- M-M
- R-M
- M-R
- R-D
- M-D
, где R ---  регистр, M ---  память, D --- данные

Операнды могут находиться в регистрах, памяти и непосредственно в команде и размер операндов может быть --- байт, слово или двойное слово
Исполняемый адрес операнда в общем случае может состоять из трёх частей: <база><индекс><смещение>, например, \[BX]\[SI]M
Существуют различные способы адресации операндов, такие как:
- Регистровая
- Непосредственная
- Прямая
- Косвенно-регистровая
- По базе со смещением
- Прямая с индексированием
- По базе с индексированием
- Ковсенная адресация с масштабированием
- Базово-индексная с масштабированием
- Базово-индексная с масштабированием

Адресации с 8 по 10 используются только в защищённом режиме

Машинный формат двухадресной команды, для которой один операнд находится всегда в регистре, а второй --- в регистре или памяти

"`dispH`/`dispL`" --- старшая/младшая часть смещения
Поля "код операции" и иногда "reg" определяют выполняемую операцию
Поле "d" определяет место хранения первого операнда
Поле "w" определяет с какими данными работают: с байтами, или словами. Если w = 0, команда работает с байтами, w = 1 --- со словами
"reg" ---  опредеяет один операнд, хранимый в регистре
Поля "mod", "dispH" и "dispL" определяют второй операнд, который хранится в регистре или в памяти.
Если mod=11, то второй операнд находится в регистре, он определяется полем "r/m", а "disp H/disp L" — отсутствует, команда будет занимать 2 байта в памяти, если mod < > 11, то второй операнд находится в памяти.

...

## Примеры команд с различной адресацией операндов
В командах на Ассемблере результат всегда пересылается по адресу первого операнда

1) Регистровая:
	- `MOV AX, BX; (BX) -> AX`
	- Машинный формат: `1001 0011 1100 0011`
	- Код операции: `100100`
	- d = 1
	- w = 1
	- mod =11
	- reg = 000
	- r/m = 11
2) Непосредственная
	- `MOV AX, 25; 25 -> AX`
	- `CONST EQU 34h; именованная константа CONST
3) Прямая
	- Если известен адрес оперативной памяти, начиная с которого размещается операнд, то в команде можно непосредственно указать этот адрес
	- `MOV AX, ES: 0001
	- `ES` --- регистр сегмента данных, `0001` --- смещение внутри сегмента
	- Содержимое двух байтов, начиная с адреса `(ES) + 0001` пересылаются в `AX` --- `((ES) + 0001) -> AX
	- Прямая адресация может быть записсана с помощью символического имени, которое предварительно поставлено в соответствие некоторому адресу памяти, с помощью специальной директивы оперативной памяти, например:
		- `DB` --- байт
		- `DW` --- слово
		- `DD` --- двойное слово
	- Если в сегмента содержится директива `Var_p DW ?`, тогда по команде `MOV AX, ES: Var_p ; ((ES) + Var_p) -> AX
	- Содержимое двух байтов, начиная с `ES` переместится в `AX`
	- Например, если команда имеет вид:
		- `MOV AX, Var_p; ((DS) + Var_p) -> AX`
4) Косвенно-регистровая
	-  Данный вид адресации отличается от регистровой адресации тем, что в регистре содержится не операнд, а адрес области памяти, в которой операнд содержится
		- `MOV AX, \[SI];
	-  Могут испольховаться регистры: `SI`, `DI`, `BX`, `BP`, `EAX`, `EBX`, `ECX`,  `EDX`, `EBP`, `ESI`, `EDI`
	- Не могут использоваться: `AX`, `CX`, `DX`, `SP`, `ESP`
5) По базе со смещением 
	`MOV AX, \[BX] + 2; ((DS) + (BX) + 2) -> AX`
	`=== MOV AX, \[BX + 2]`
	`=== MOV AX, 2\[BX]`
6) Прямая с индексированием
	- `MOV AX, MAS\[SI]: ((DS) + (SI) + MAS) -> AX
	- `MAS` --- адрес в области памяти
	- С помощью этой адресации можно работать с одномерными массивами. Символическое имя определяет начало массива, а переход от одного элемента к другому осуществляется с помощью содержимого индексного регистра
7) По базе с индексированием
- `MOV AX, Arr\[BX]\[DI]; ((DS) + (BX) + (DI) + Arr) -> AX
 Эта адресация используется для работы с двумерными массивами. Символическое имя определяет начало массива, с помощью базового регистра осуществляется переход от одной строки матрицы к другой, а с помощью индексного регистра --- переход от одного элемента к другому внутри строки